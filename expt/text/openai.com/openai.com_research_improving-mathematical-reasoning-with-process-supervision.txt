


Improving mathematical reasoning with process supervision












CloseSearch Submit Skip to main contentSite NavigationResearchOverviewIndexProductOverviewChatGPTGPT-4DALLÂ·E 2Customer storiesSafety standardsAPI data privacyPricingDevelopersOverviewDocumentationAPI referenceExamplesSafetyCompanyAboutBlogCareersCharterSecuritySearch Navigation quick links Log inSign upMenu Mobile Navigation CloseSite NavigationResearchProductDevelopersSafetyCompany Quick Links Log inSign upSearch Submit Improving mathematical reasoning with process supervisionIllustration: Ruby ChenWe've trained a model to achieve a new state-of-the-art in mathematical problem solving by rewarding each correct step of reasoning (âprocess supervisionâ) instead of simply rewarding the correct final answer (âoutcome supervisionâ). In addition to boosting performance relative to outcome supervision, process supervision also has an important alignment benefit: it directly trains the model to produce a chain-of-thought that is endorsed by humans.May 31, 2023More resourcesRead paperBrowse samplesDownload datasetResearch,Â ReasoningIntroductionIn recent years, large language models have greatly improved in their ability to perform complex multi-step reasoning. However, even state-of-the-art models still produce logical mistakes, often called hallucinations. Mitigating hallucinations is a critical step towards building aligned AGI.We can train reward models to detect hallucinations using either outcome supervision, which provides feedback based on a final result, or process supervision, which provides feedback for each individual step in a chain-of-thought. Building on previous work[^reference-1], we conduct a detailed comparison of these two methods using the MATH dataset[^reference-2] as our testbed. We find that process supervision leads to significantly better performance, even when judged by outcomes. To encourage related research, we release our full dataset of process supervision.Alignment impactProcess supervision has several alignment advantages over outcome supervision. It directly rewards the model for following an aligned chain-of-thought, since each step in the process receives precise supervision. Process supervision is also more likely to produce interpretable reasoning, since it encourages the model to follow a human-approved process. In contrast, outcome supervision may reward an unaligned process, and it is generally harder to scrutinize.In some cases, safer methods for AI systems can lead to reduced performance[^reference-3], a cost which is known as an alignment tax. In general, any alignment tax may hinder the adoption of alignment methods, due to pressure to deploy the most capable model. Our results below show that process supervision in fact incurs a negative alignment tax, at least in the math domain. This could increase the adoption of process supervision, which we believe would have positive alignment side-effects.Solving MATH problemsWe evaluate our process-supervised and outcome-supervised reward models using problems from the MATH test set. We generate many solutions for each problem and then pick the solution ranked the highest by each reward model. The graph shows the percentage of chosen solutions that reach the correct final answer, as a function of the number of solutions considered. Not only does the process-supervised reward model perform better across the board, but the performance gap widens as we consider more solutions per problem. This shows us that the process-supervised reward model is much more reliable.We showcase 10 problems and solutions below, along with commentary about the reward modelâs strengths and weaknesses.Explore examples in 3 categories:True positivesTrue negativesFalse positivesProblemSimplify tanâ¡100â+4sinâ¡100â.\tan 100^\circ + 4 \sin 100^\circ.tan100â+4sin100â.1 / 4Model attemptThis challenging trigonometry problem requires applying several identities in a not-at-all obvious succession. Most solution attempts fail, because it is hard to choose which identities are actually helpful. Although GPT-4 usually canât solve this problem (only .1%.1\%.1% of solution attempts reach the correct answer), the reward model correctly recognizes that this solution is valid.1I notice that the angle 100 degrees is not a special angle, so I will need to use some trigonometric identities to simplify this expression.2I recall that tanâ¡Î¸=sinâ¡Î¸cosâ¡Î¸\tan \theta = \frac{\sin \theta}{\cos \theta}tanÎ¸=cosÎ¸sinÎ¸â and sinâ¡2Î¸=2sinâ¡Î¸cosâ¡Î¸.\sin 2\theta = 2 \sin \theta \cos \theta.sin2Î¸=2sinÎ¸cosÎ¸.3I can use these identities to rewrite the expression as sinâ¡100âcosâ¡100â+4sinâ¡100â.\frac{\sin 100^\circ}{\cos 100^\circ} + 4 \sin 100^\circ.cos100âsin100ââ+4sin100â.4I can combine the terms by finding a common denominator of cosâ¡100â.\cos 100^\circ.cos100â.5I get sinâ¡100â+4sinâ¡100âcosâ¡100âcosâ¡100â.\frac{\sin 100^\circ + 4 \sin 100^\circ \cos 100^\circ}{\cos 100^\circ}.cos100âsin100â+4sin100âcos100ââ.6I can simplify the numerator by using the double angle identity again, but in reverse.7I get sinâ¡100â+2sinâ¡200âcosâ¡100â.\frac{\sin 100^\circ + 2 \sin 200^\circ}{\cos 100^\circ}.cos100âsin100â+2sin200ââ.8I notice that 200 degrees is the same as 180 degrees plus 20 degrees, so I can use the sum angle identity for sine.9I get sinâ¡100â+2(sinâ¡180âcosâ¡20â+cosâ¡180âsinâ¡20â)cosâ¡100â.\frac{\sin 100^\circ + 2 (\sin 180^\circ \cos 20^\circ + \cos 180^\circ \sin 20^\circ)}{\cos 100^\circ}.cos100âsin100â+2(sin180âcos20â+cos180âsin20â)â.10I recall that sinâ¡180â=0\sin 180^\circ = 0sin180â=0 and cosâ¡180â=â1,\cos 180^\circ = -1,cos180â=â1, so I can simplify further.11I get sinâ¡100ââ2sinâ¡20âcosâ¡100â.\frac{\sin 100^\circ - 2 \sin 20^\circ}{\cos 100^\circ}.cos100âsin100ââ2sin20ââ.12I notice that 100 degrees is the same as 90 degrees plus 10 degrees, so I can use the sum angle identity for sine and cosine.13I get (sinâ¡90âcosâ¡10â+cosâ¡90âsinâ¡10â)â2sinâ¡20â(cosâ¡90âcosâ¡10ââsinâ¡90âsinâ¡10â).\frac{(\sin 90^\circ \cos 10^\circ + \cos 90^\circ \sin 10^\circ) - 2 \sin 20^\circ}{(\cos 90^\circ \cos 10^\circ - \sin 90^\circ \sin 10^\circ)}.(cos90âcos10ââsin90âsin10â)(sin90âcos10â+cos90âsin10â)â2sin20ââ.14I recall that sinâ¡90â=1\sin 90^\circ = 1sin90â=1 and cosâ¡90â=0,\cos 90^\circ = 0,cos90â=0, so I can simplify further.15I get cosâ¡10ââ2sinâ¡20ââsinâ¡10â.\frac{\cos 10^\circ - 2 \sin 20^\circ}{-\sin 10^\circ}.âsin10âcos10ââ2sin20ââ.16I can simplify the sign by multiplying the numerator and denominator by -1.17I get 2sinâ¡20ââcosâ¡10âsinâ¡10â.\frac{2 \sin 20^\circ - \cos 10^\circ}{\sin 10^\circ}.sin10â2sin20ââcos10ââ.18I notice that 20 degrees is the same as 30 degrees minus 10 degrees, so I can use the difference angle identity for sine.19I get 2(sinâ¡30âcosâ¡10ââcosâ¡30âsinâ¡10â)âcosâ¡10âsinâ¡10â.\frac{2 (\sin 30^\circ \cos 10^\circ - \cos 30^\circ \sin 10^\circ) - \cos 10^\circ}{\sin 10^\circ}.sin10â2(sin30âcos10ââcos30âsin10â)âcos10ââ.20I recall that sinâ¡30â=12\sin 30^\circ = \frac{1}{2}sin30â=21â and cosâ¡30â=32,\cos 30^\circ = \frac{\sqrt{3}}{2},cos30â=23ââ, so I can simplify further.21I get cosâ¡10ââ3sinâ¡10ââcosâ¡10âsinâ¡10â.\frac{\cos 10^\circ - \sqrt{3} \sin 10^\circ - \cos 10^\circ}{\sin 10^\circ}.sin10âcos10ââ3âsin10ââcos10ââ.22I can cancel out the cosâ¡10â\cos 10^\circcos10â terms in the numerator.23I get â3sinâ¡10âsinâ¡10â.\frac{-\sqrt{3} \sin 10^\circ}{\sin 10^\circ}.sin10ââ3âsin10ââ.24I can cancel out the sinâ¡10â\sin 10^\circsin10â terms in the numerator and denominator.25I get â3.-\sqrt{3}.â3â.26Answer: â3-\sqrt{3}â3âIt is unknown how broadly these results will generalize beyond the domain of math, and we consider it important for future work to explore the impact of process supervision in other domains. If these results generalize, we may find that process supervision gives us the best of both worlds â a method that is both more performant and more aligned than outcome supervision.AuthorsKarl CobbeHunter LightmanVineet KosarajuYura BurdaHarri EdwardsJan LeikeIlya SutskeverAcknowledgmentsContributorsBowen Baker, Teddy Lee, John Schulman, Greg Brockman, Kendra Rimbach, Hannah Wong, Thomas DegryResearchOverviewIndexProductOverviewChatGPTGPT-4DALLÂ·E 2Customer storiesSafety standardsAPI data privacyPricingSafetyOverviewCompanyAboutBlogCareersCharterSecurityOpenAI Â© 2015âââ2023Terms & policiesPrivacy policyBrand guidelinesSocialTwitterYouTubeGitHubSoundCloudLinkedInBack to top
