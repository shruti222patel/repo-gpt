


Learning to summarize with human feedback












CloseSearch Submit Skip to main contentSite NavigationResearchOverviewIndexProductOverviewChatGPTGPT-4DALLÂ·E 2Customer storiesSafety standardsAPI data privacyPricingDevelopersOverviewDocumentationAPI referenceExamplesSafetyCompanyAboutBlogCareersCharterSecuritySearch Navigation quick links Log inSign upMenu Mobile Navigation CloseSite NavigationResearchProductDevelopersSafetyCompany Quick Links Log inSign upSearch Submit Learning to summarize with human feedbackWeâve applied reinforcement learning from human feedback to train language models that are better at summarization.September 4, 2020More resourcesRead paperView codeView samplesLanguage,Â Human feedback,Â Safety & Alignment,Â Summarization,Â Milestone,Â Publication,Â ReleaseWhy it mattersOur models generate summaries that are better than summaries from 10x larger models trained only with supervised learning. Even though we train our models on the Reddit TL;DR dataset, the same models transfer to generate good summaries of CNN/DailyMail news articles without any further fine-tuning. Our techniques are not specific to summarization; in the long run, our goal is to make aligning AI systems with human preferences a central component of AI research and deployment in many domains.Human feedback models outperform much larger supervised models and reference summaries on TL;DRFigure 1: The performance of various training procedures for different model sizes. Model performance is measured by how often summaries from that model are preferred to the human-written reference summaries. Our pre-trained models are early versions of GPT-3, our supervised baselines were fine-tuned to predict 117K human-written TL;DRs, and our human feedback models are additionally fine-tuned on a dataset of about 65K summary comparisons.Large-scale language models are becoming increasingly capable on NLP tasks. These models are usually trained with the objective of next word prediction on a dataset of human-written text. But this objective doesnât capture exactly what we want; usually, we donât want our models to imitate humans, we want them to give high-quality answers. This mismatch is clear when a model is trained to imitate low-quality human-written text, but it can also happen in more subtle ways. For example, a model trained to predict what a human would say might make up facts when it is unsure, or generate sentences reflecting harmful social bias, both failure modes that have been well-documented.[^reference-3][^reference-4][^reference-5][^reference-6]As part of our work on safety, we want to develop techniques that align our modelsâ objectives with the end behavior we really care about. As our models become more powerful, we believe aligning them with our goals will be very important to ensure they are beneficial for humans. In the short term, we wanted to test if human feedback techniques could help our models improve performance on usefulÂ tasks.We focused on English text summarization, as itâs a challenging problem where the notion of what makes a âgood summaryâ is difficult to capture without human input. We apply our method primarily to an existing dataset[^reference-1]Â of posts submitted to the social network Reddit[^footnote-reddit]Â together with human-written âTL;DRs,â which are short summaries written by the originalÂ poster.We first train a reward model via supervised learning to predict which summaries humans will prefer.[^footnote-prefer]Â We then fine-tune a language model with reinforcement learning (RL) to produce summaries that score highly according to that reward model. We find that this significantly improves the quality of the summaries, as evaluated by humans, even on datasets very different from the one used forÂ fine-tuning.Our approach follows directly fromÂ our previous workÂ on learning from human feedback.[^reference-7]Â There has also been other work on using human feedback to train summarization models.[^reference-8]Â We push the technique further by scaling to larger models, collecting more feedback data, closely monitoring researcher-labeler agreement, and providing frequent feedback to labelers. Human feedback has also been used to train models in several other domains, such as dialogue,[^reference-9][^reference-10][^reference-11]Â semantic parsing,[^reference-12]Â translation,[^reference-13][^reference-14]Â story[^reference-15]Â and review[^reference-16]Â generation, evidence extraction,[^reference-17]Â and more traditional RL tasks.[^reference-18][^reference-19]ResultsPrevNextLoading samplesâ¦We evaluated several different summarization modelsâsome pre-trained on a broad distribution of text from the internet, some fine-tuned via supervised learning to predict TL;DRs, and some fine-tuned using human feedback.[^footnote-feedback] To evaluate each model, we had it summarize posts from the validation set and asked humans to compare their summaries to the human-written TL;DR. The results are shown inÂ FigureÂ 1.We found that RL fine-tuning with human feedback had a very large effect on quality compared to both supervised fine-tuning and scaling up model size. In particular, our 1.3 billion parameter (1.3B) model trained with human feedback outperforms our 12B model trained only with supervised learning. Summaries from both our 1.3B and 6.7B human feedback models are preferred by our labelers to the original human-written TL;DRs in the dataset.[^footnote-dataset]People make different trade-offs when writing summaries, including between conciseness and coverage of the original text; depending on the purpose of the summary, different summary lengths might be preferred. Our labelers tended to prefer longer summaries, so our models adapted to that preference and converged to the longest allowable length. Controlling for length reduced human preferences for our 6.7B modelâs summaries from 70% to 65%, explaining a minority of our gains.[^footnote-gains]Transfer results Human feedback models trained on Reddit transfer to generate excellent summaries of CNN/DM news articles without further training Raw scoresLength-controlledThe performance (human-rated summary quality on a 1â7 scale) of various training procedures and model sizes. Note that our human feedback models generate summaries that are significantly shorter than summaries from models trained on CNN/DM.At a given summary length, our 6.7B human feedback model trained on Reddit performs almost as well as a fine-tuned 11B T5 model, despite not being re-trained on CNN/DM.PrevNextResultsLoading samplesâ¦To test our modelsâ generalization, we also applied them directly to the popular CNN/DM news dataset.[^reference-2]Â These articles are more than twice as long as Reddit posts and are written in a very different style. Our models have seen news articles during pre-training, but all of our human data and RL fine-tuning was on the Reddit TL;DRÂ dataset.This time we evaluated our models by asking our labelers to rate them on a scale from 1â7.[^footnote-scale] We discovered that our human feedback models transfer to generate excellent short summaries of news articles without any training. When controlling for summary length, our 6.7B human feedback model generates summaries that are rated higher than the CNN/DM reference summaries written by humans. This suggests that our human feedback models have learned something more general about how to summarize text, and are not specific to RedditÂ posts.ApproachA diagram of our method, which is similar to the one used in our previous work.Our core method consists of four steps: training an initial summarization model, assembling a dataset of human comparisons between summaries, training a reward model to predict the human-preferred summary, and then fine-tuning our summarization models with RL to get a highÂ reward.We trained several supervised baselines by starting from GPT-style transformer models trained on text from the Internet,20Â and fine-tuning them to predict the human-written TL;DR via supervised learning. We mainly use models with 1.3 and 6.7 billion parameters. As a sanity check, we confirmed that this training procedure led to competitive results[^footnote-competitive-results] on the CNN/DMÂ dataset.We then collected a dataset of human quality judgments. For each judgment, a human compares two summaries of a given post and picks the one they think is better.[^footnote-better] We use this data to train a reward model that maps aÂ (post, summary)Â pair to a rewardÂ r. The reward model is trained to predict which summary a human will prefer, using the rewards asÂ logits.Finally, we optimize the policy against the reward model using RL. We useÂ PPOÂ with 1 million episodes in total, where each episode consists of the policy summarizing a single article and then receiving a rewardÂ r. We include a KL penalty that incentivizes the policy to remain close to the supervisedÂ initialization.Collecting data from humansAny training procedure that uses human feedback is directly influenced by the actual humans labeling the data. In our previous work on fine-tuning language models from human preferences,7Â our labelers often gave high ratings to summaries we thought were average, which was reflected in the quality of our trainedÂ models.In response, in this project we invested heavily in ensuring high data quality. We hired about 80 contractors using third-party vendor sites,[^footnote-vendor-sites]Â and paid them an hourly wage regardless of the number of summaries evaluated.[^footnote-evaluated] Hiring contractors rather than relying on crowdsourcing websites allowed us to maintain a hands-on relationship with labelers: we created an onboarding process, developed a website with a customizable labeler interface, answered questions in a shared chat room, and had one-on-one video calls with labelers. We also made sure to clearly communicate our definition of summary quality, after spending significant time reading summaries ourselves, and we carefully monitored agreement rates between us and labelers throughout theÂ project.Optimizing the reward modelOptimizing our reward model eventually leads to sample quality degradationStarting from the 1.3B supervised baseline (point 0 on the x-axis), we use RL to optimize the policy against the reward model, which results in policies with different âdistancesâ from the baseline (x-axis, measured using the KL divergence from the supervised baseline). Optimizing against the reward model initially improves summaries according to humans, but eventually overfits, giving worse summaries. This chart uses an older version of our reward model, which is why the peak of the reward model is less than 0.5.Post from Reddit (r/AskReddit) Iâm a 28yo man, and I would like to get into gymnastics for the first time.  Title said just about all of it. Iâm 28, very athletic (bike/ surf/ snowboard) and I have always wanted to do gymnastics. I like to do flips and spins off bridges and on my snowboard, and it seems to me gymnastics would be a great way to do those movements I like, in a controlled environment. The end goal of this is that it would be fun, and make me better at these movements in real life.But is it too late for me? Should 28 year old guys such as myself be content with just watching those parkour guys on youtube? Or can I learn the ways of the gymnastic jedi? BTW, I live in San Jose CA. KL = 0 I want to do gymnastics, but Iâm 28 yrs old. Is it too late for me to be a gymnaste?! KL = 9 28yo guy would like to get into gymnastics for the first time. Is it too late for me given I live in San Jose CA? KL = 260  28yo dude stubbornly postponees start pursuing gymnastics hobby citing logistics reasons despite obvious interest??? negatively effecting long term fitness progress both personally and academically thoght wise? want change this dumbass shitty ass policy pls Optimizing against our reward model is supposed to make our policy align with human preferences. But the reward model is only a proxy for human preferences, as it only sees a small amount of comparison data from a narrow distribution of summaries. While the reward model performs well on the kinds of summaries it was trained on, we wanted to know how much we could optimize against it until it started giving uselessÂ evaluations.We trained policies at different âoptimization strengthsâ against the reward model, and asked our labelers to evaluate the summaries from these models. We did this by varying the KL coefficient, which trades off the incentive to get a higher reward against the incentive to remain close to the initial supervised policy. We found the best samples had roughly the same predicted reward as the 99th percentile of reference summaries from the dataset. Eventually optimizing the reward model actually makes thingsÂ worse.LimitationsIf we have a well-defined notion of the desired behavior for a model, our method of training from human feedback allows us to optimize for this behavior. However, this is not a method for determining what the desired model behaviorÂ should be. Deciding what makes a good summary is fairly straightforward, but doing this for tasks with more complex objectives, where different humans might disagree on the correct model behavior, will require significant care. In these cases, it is likely not appropriate to use researcher labels as the âgold standardâ; rather, individuals from groups that will be impacted by the technology should be included in the process to define âgoodâ behavior, and hired as labelers to reinforce this behavior in theÂ model.We trained on the Reddit TL;DR dataset1Â because the summarization task is significantly more challenging than on CNN/DM. However, since the dataset consists of user-submitted posts with minimal moderation, they sometimes contain content that is offensive or reflects harmful social biases. This means our models can generate biased or offensive summaries, as they have been trained to summarize suchÂ content.Part of our success involves scaling up our reward model and policy size. This requires a large amount of compute, which is not available to all researchers: notably, fine-tuning our 6.7B model with RL required about 320 GPU-days. However, since smaller models trained with human feedback can exceed the performance of much larger models, our procedure is more cost-effective than simply scaling up for training high-quality models on specificÂ tasks.Though we outperform the human-written reference summaries on TL;DR, our models have likely not reached human-level performance, as the reference summary baselines for TL;DR and CNN/DM are not the highest possible quality. When evaluating our modelâs TL;DR summaries on a 7-point scale along several axes of quality (accuracy,Â coverage,Â coherence, andÂ overall), labelers find our models can still generate inaccurate summaries, and give a perfectÂ overallÂ score 45% of the time.[^footnote-time] For cost reasons, we also do not directly compare to using a similar budget to collect high-quality demonstrations, and training on those using standard supervisedÂ fine-tuning.Future directionsWeâre interested in scaling human feedback to tasks where humans canât easily evaluate the quality of model outputs. For example, we might want our models to answer questions that would take humans a lot of research to verify; getting enough human evaluations to train our models this way would take a long time. One approach to tackle this problem is to give humans tools to help them evaluate more quickly and accurately. If these tools use ML, we can also improve them with human feedback, which could allow humans to accurately evaluate model outputs for increasingly complicated tasks.[^reference-23]In addition to tackling harder problems, weâre also exploring different types of feedback beyond binary comparisons: we can ask humans to provide demonstrations, edit model outputs to make them better, or give explanations as to why one model output is better than another. Weâd like to figure out which kinds of feedback are most effective for training models that are aligned with humanÂ preferences.If you are interested in working on these research questions,Â weâreÂ hiring!AuthorsNisan StiennonPaul ChristianoDaniel ZieglerRyan LoweJeffrey WuChelsea VossLong OuyangAcknowledgmentsWeâd like to thank the following people who gave feedback on various iterations of the blog post: Douwe Kiela, Zach Lipton, Alex Irpan, Jack Clark, Jacob Hilton, Raul Puri, Miles Brundage, Greg Brockman, Ilya Sutskever, Kelly Sims, Wojciech Kryscinski, and Dzimitry Bahdanau. Weâd also like to thank Justin Jay Wang for driving the blog post design, Ashley Pilipiszyn for editing, Alec Radford and Dario Amodei for guidance on the project, Shan Carter for help designing the main diagram, Gretchen Krueger for co-writing the model card, Beth Barnes for help with labeler hiring and general encouragement, and many other people at OpenAI for training our large pre-trained models, supporting us through computing infrastructure improvements and maintenance, and writing fast GPU kernels. Finally, weâd like to thank all of our contractors for providing the data that was essential for training the models in this post.ResearchOverviewIndexProductOverviewChatGPTGPT-4DALLÂ·E 2Customer storiesSafety standardsAPI data privacyPricingSafetyOverviewCompanyAboutBlogCareersCharterSecurityOpenAI Â© 2015âââ2023Terms & policiesPrivacy policyBrand guidelinesSocialTwitterYouTubeGitHubSoundCloudLinkedInBack to top
